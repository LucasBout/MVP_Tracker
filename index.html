<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
  <script src="http://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    <link rel="icon" href="assets/mvp_tracker_logo.png" type="image/x-icon">
  <link href="dist/tailwind.css" rel="stylesheet">
  <link rel="stylesheet" href="http://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
  <title>D3.js Project</title>
</head>
<body>
<img src="assets/mvp_tracker_logo.png" alt="logo" class="mx-auto w-32 my-0" >
<div id="charts-section" class="flex flex-col items-center justify-center bg-gray-100 rounded-lg p-5 shadow-[0_4px_8px_rgba(0,0,0,0.2)] w-3/5 mx-auto">
  <div id="chart"></div>
  <div id="subcharts" class="flex flex-wrap justify-center"></div>
</div>
<div class="mt-10">
  <div style="width: 70%; margin: auto" id="intervalleAnnee" class="d-flex flex-column justify-content-center align-items-center">
    <div id="slider"></div>
  </div>
  <p class="w-full text-center flex flex-col justify-center items-center my-3 text-xl">
    <label for="anneeLabel">Intervalle d'année:</label>
    <input type="text" id="anneeLabel" readonly class="text-center w-min border-0">
  </p>
</div>

<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="average.js"></script>
<body class="bg-gray-100 min-h-screen flex flex-col">

  <!-- Header avec logo centré et fond transparent -->
  <header class="w-full bg-transparent py-4 flex justify-center">
    <img id="logo" src="image/logo.png" alt="MVP Tracker Logo" class="max-w-[200px]">
  </header>

  <!-- Contenu principal -->
  <main class="flex flex-col items-center w-full max-w-screen-xl mx-auto mt-8">
    <!-- Conteneur des deux graphiques bien écartés -->
    <div id="charts-container" class="w-full flex justify-between gap-20">
      
      <!-- Graphique Camembert (Aligné à gauche) -->
      <div id="camembert" class="bg-white shadow-md rounded-lg p-5 w-1/2 max-w-[600px] pl-10 overflow-hidden">
        <!-- D3.js insérera son contenu ici -->
      </div>

      <!-- Deuxième Graphique (Aligné à droite) -->
      <div id="chart-right" class="bg-white shadow-md rounded-lg p-5 w-1/2 max-w-[600px] pr-10 overflow-hidden">
        <!-- D3.js insérera son contenu ici -->
      </div>
    </div>
  </main>

  <!-- Scripts -->
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", async function () {
      if (!window.d3) {
        console.error("D3.js n'a pas pu être chargé.");
        return;
      }

      try {
        // Chargement des données JSON
        const response = await fetch('data/data.json'); // Assurez-vous que ce fichier existe
        const mvpData = await response.json();

        const totalTeams = mvpData.length;
        const championshipWins = mvpData.filter(d => d.teamWonChampionship).length;
        const noChampionshipWins = totalTeams - championshipWins;

        const dataset = [
            { label: "Victoire avec MVP", value: championshipWins },
            { label: "Défaite avec MVP", value: noChampionshipWins },
        ];

        const width = 350;
        const height = 350;
        const radius = Math.min(width, height) / 2;

        const color = d3.scaleOrdinal()
            .domain(dataset.map(d => d.label))
            .range(["#5cb7e9", "#fc0a2c"]);

        const svgCamembert = d3.select('#camembert')
            .append('svg')
            .attr('width', width)
            .attr('height', height)
            .append('g')
            .attr('transform', `translate(${width / 2}, ${height / 2})`);

        const pie = d3.pie()
            .value(d => d.value);

        const data_ready = pie(dataset);

        const arc = d3.arc()
            .innerRadius(0)
            .outerRadius(radius);

        svgCamembert.selectAll('path')
            .data(data_ready)
            .join('path')
            .attr('d', arc)
            .attr('fill', d => color(d.data.label));

        svgCamembert.selectAll('text')
            .data(data_ready)
            .join('text')
            .text(d => `${d.data.label}: ${((d.data.value / totalTeams) * 100).toFixed(1)}%`)
            .attr('transform', d => `translate(${arc.centroid(d)})`)
            .style('text-anchor', 'middle')
            .style('font-size', '14px');

      } catch (error) {
        console.error('Erreur lors du chargement des données JSON :', error);
      }
    });
  </script>

</body>
</html>